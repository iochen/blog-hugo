<!doctype html><html lang=en><meta charset=utf-8><meta name=generator content="Hugo 0.74.1"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><link rel=preload href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/fonts/fontawesome-webfont.woff2?v=4.7.0" as=font><title>openssl RSAç®€å•ä½¿ç”¨&nbsp;&ndash;&nbsp;Richard Chen's Blog</title><link href=https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css rel=stylesheet rel=preload as=style><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/iochen/blog-hugo@public/css/core.min.557e0a83d4005903199dab1bea2ca687eea4e9446d981e750f1adb938250c0bf5a28160fb840e3d24c9f22bea1e66433.css integrity=sha384-VX4Kg9QAWQMZnasb6iymh+6k6URtmB51Dxrbk4JQwL9aKBYPuEDj0kyfIr6h5mQz crossorigin=anonymous><meta name=twitter:card content="summary"><meta name=twitter:title content="openssl RSAç®€å•ä½¿ç”¨"><body><section id=header><div class="header wrap"><span class=header><a class="site home" href=/><img class="site logo" src=https://cdn.jsdelivr.net/gh/iochen/blog-hugo@public/images/logo.svg crossorigin=anonymous alt><span class="site name">Richard Chen's Blog</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class="nav item" href=/categories/>Categories</a>&nbsp;|&nbsp;<a class="nav item" href=/tags/>Tags</a>&nbsp;|&nbsp;<a class="nav item" href=/about/>About</a>&nbsp;|&nbsp;<a class="nav item" href=/links/>Links</a>&nbsp;|&nbsp;<a class="nav item" href=/search/>Search</a>&nbsp;|&nbsp;</nav></div></span><span class="m-header right-side"><button onclick="Toggle('menu')" class=menubtn><i class="fa fa-bars fa-lg" aria-hidden=true></i></button></span><ul id=menu class="menu dropdown"><li class=menu-item><a href=/categories/><br>Categories</a></li><li class=menu-item><a href=/tags/><br>Tags</a></li><li class=menu-item><a href=/about/><br>About</a></li><li class=menu-item><a href=/links/><br>Links</a></li><li class=menu-item><a href=/search/><br>Search</a></li></ul><script>function Toggle(id){var dropdown=document.getElementById(id);if(dropdown.classList.contains('show')){dropdown.classList.remove('show');}else{dropdown.classList.add('show');}}</script></div></section><section id=content><div class=article-container><section class="article header"><h2 class=title>openssl RSAç®€å•ä½¿ç”¨</h2><div class=post-meta><i class="fa fa-calendar-o"></i>&nbsp;<span>2018-02-10</span><a> | </a><i class="fa fa-folder-o"></i>&nbsp;<a class=post-meta href=/categories/crypto/>Crypto&nbsp;&nbsp;</a></div></section><article class="article markdown-body"><p>æœ€è¿‘çœ‹åˆ°çš„å…³äºTLSçš„æ–‡ç« æ¯”è¾ƒå¤šå•Šï¼Œæˆ‘ä¹Ÿæ¥å‡‘å‡‘çƒ­é—¹ï¼Œæ¥ä¸€ç¯‡å…³äºéå¯¹ç§°åŠ å¯†ç”¨æ³•çš„åšå®¢ã€‚å½“ç„¶äº†ï¼Œè¿™ç¯‡æ–‡ç« å¯¹ä¸æ‡‚çš„äººä¹Ÿæ²¡ä»€ä¹ˆç”¨ï¼Œæ‡‚çš„äººä¹Ÿä¸ä¼šçœ‹è¿™ç¯‡ï¼Œè¿˜æ˜¯å†™ç»™è‡ªå·±çœ‹å§</p><p>è¿™é‡Œçš„éå¯¹ç§°åŠ å¯†ç”¨çš„æ˜¯<strong>RSA</strong></p><h1 id=åŸºæœ¬>åŸºæœ¬</h1><p>éå¯¹ç§°åŠ å¯†å¯†é’¥çš„ç”¨æ³•ä¸»è¦æ˜¯å¦‚ä¸‹å‡ ç§ï¼š</p><pre><code>åŠ å¯† â†’ å…¬é’¥
è§£å¯† â†’ ç§é’¥
ç­¾å â†’ ç§é’¥
è§£å¯† â†’ ç§é’¥
</code></pre><h1 id=ç”¨æ³•>ç”¨æ³•</h1><h2 id=ç”Ÿæˆå¯†é’¥>ç”Ÿæˆå¯†é’¥</h2><h3 id=ç”Ÿæˆç§é’¥>ç”Ÿæˆç§é’¥</h3><p>æ¯”å¦‚æˆ‘è¦ç”Ÿæˆä¸€ä¸ªå«<code>pr.pem</code>çš„ç§é’¥æ–‡ä»¶ï¼Œç›´æ¥</p><pre><code>openssl genrsa -out pr.pem
</code></pre><p>å°±å¯ä»¥äº†ï¼Œå°±åƒè¿™æ ·ï¼š
<img src=https://cdn.jsdelivr.net/gh/iochen/blog-hugo@public/img/openssl-RSA-1/f05d8842-7080-4b4c-bcc2-bbc07ceaefc5.png alt=ç”Ÿæˆç§é’¥></p><h3 id=æå–å…¬é’¥>æå–å…¬é’¥</h3><p>æ¯”å¦‚æˆ‘è¦ä»<code>pr.pem</code>é‡Œæå–<code>pu.pem</code>çš„å…¬é’¥ï¼Œç›´æ¥</p><pre><code>openssl rsa -pubout -in pr.pem -out pu.pem
</code></pre><p>å³å¯ï¼Œå¯ä»¥çœ‹åˆ°ï¼š
<img src=https://cdn.jsdelivr.net/gh/iochen/blog-hugo@public/img/openssl-RSA-1/6ed6724b-1fac-415e-bd11-8403680fe04c.png alt=æå–å…¬é’¥></p><h3 id=å°ç»“>å°ç»“</h3><p>è‡³æ­¤ï¼Œå…¬é’¥å’Œç§é’¥å°±ç”Ÿæˆå¥½äº†ï¼Œæ¥çœ‹çœ‹å§ï¼<br>ç§é’¥ï¼š<br><img src=https://cdn.jsdelivr.net/gh/iochen/blog-hugo@public/img/openssl-RSA-1/b567d11b-55c7-4e2e-9629-32a406427301.png alt=ç§é’¥>
å…¬é’¥ï¼š<br><img src=https://cdn.jsdelivr.net/gh/iochen/blog-hugo@public/img/openssl-RSA-1/4f6e2b69-034f-4bdd-a02a-52ef9310e0bd.png alt=å…¬é’¥></p><h2 id=åŠ è§£å¯†>åŠ è§£å¯†</h2><h3 id=åŠ å¯†>åŠ å¯†</h3><p>æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªå«<code>test</code>çš„æ–‡ä»¶ï¼Œå†™ç‚¹ä»€ä¹ˆ
<img src=https://cdn.jsdelivr.net/gh/iochen/blog-hugo@public/img/openssl-RSA-1/35036b25-44cf-4565-a645-ff2719ce065e.png alt=æµ‹è¯•æ–‡ä»¶>
æ¥ä¸‹æ¥åŠ å¯†</p><pre><code>openssl rsautl -pubin -encrypt -in test -inkey pu.pem -out test_en
</code></pre><p>æ¥çœ‹çœ‹åŠ å¯†åçš„æ–‡ä»¶ï¼š<br><em>æ³¨ï¼šç°åœ¨ç”¨<code>cat</code>æ˜¯çœ‹ä¸äº†çš„ï¼Œåªæ˜¯ä¸€å †ä¹±ç ï¼Œæ‰€ä»¥æˆ‘ç”¨<code>hexdump</code>æŸ¥çœ‹äºŒè¿›åˆ¶æ–‡ä»¶</em>
<img src=https://cdn.jsdelivr.net/gh/iochen/blog-hugo@public/img/openssl-RSA-1/a0caf393-a88d-4c94-83d5-4493d6278fa9.png alt=åŠ å¯†å></p><h3 id=è§£å¯†>è§£å¯†</h3><p>ç®€å•ï¼è¾“å…¥</p><pre><code>openssl rsautl -decrypt -in test_en -inkey pr.pem -out test_dn
</code></pre><p>åˆå›æ¥äº†ä¸æ˜¯å—ï¼<br>æ¥çœ‹çœ‹è§£å¯†åçš„æ–‡ä»¶ï¼š
<img src=https://cdn.jsdelivr.net/gh/iochen/blog-hugo@public/img/openssl-RSA-1/ed16ca35-cee3-44ff-a71d-fbcdfd57b0eb.png alt=è§£å¯†å>
å®Œå…¨ä¸€æ ·ï¼</p><h2 id=ç­¾åä¸éªŒè¯>ç­¾åä¸éªŒè¯</h2><h3 id=ç­¾å>ç­¾å</h3><p>æˆ‘æƒ³ä¸º<code>test</code>æ–‡ä»¶ç­¾åï¼Œç›´æ¥</p><pre><code>openssl dgst -sha256 -sign pr.pem -out test_sign test
</code></pre><p>å³å¯ç”Ÿæˆç­¾åæ–‡ä»¶<code>test_sign</code></p><h3 id=éªŒè¯ç­¾å>éªŒè¯ç­¾å</h3><p>ä¸€æ ·ï¼Œä¸€å¥å‘½ä»¤ï¼</p><pre><code>openssl dgst -sha256 -verify pu.pem -signature test_sign test
</code></pre><p>å¥½çš„ï¼Œå¾—åˆ°ä¸€å¥
<img src=https://cdn.jsdelivr.net/gh/iochen/blog-hugo@public/img/openssl-RSA-1/e3b95074-4eee-4d75-907e-682898c8d55f.png alt=éªŒè¯é€šè¿‡>
è¿™å°±æ˜¯éªŒè¯é€šè¿‡äº†</p><p>å¦‚æœè¿™ä¸ªåŸæ¥æ•°æ®è¢«ä¸€äº›äººä¿®æ”¹åï¼Œæ¯”å¦‚ï¼š<br><em>è¿™é‡Œæˆ‘ä¸º<code>test</code>æ–‡ä»¶åŠ äº†ä¸€è¡Œ</em>
<img src=https://cdn.jsdelivr.net/gh/iochen/blog-hugo@public/img/openssl-RSA-1/a9569407-189a-411c-9ebe-a9a19031e2c7.png alt=ä¿®æ”¹å>
å°±ä¼šå‡ºç°ï¼š
<img src=https://cdn.jsdelivr.net/gh/iochen/blog-hugo@public/img/openssl-RSA-1/d0ce75e7-7750-4b53-b574-069953fbc965.png alt=éªŒè¯å¤±è´¥></p><h2 id=æ€»ç»“>æ€»ç»“</h2><p>è¿™é‡Œæˆ‘æœ‰ä¸€äº›æ²¡æœ‰è¯´ï¼Œå› ä¸ºå†™ç€å†™ç€å°±å†™çš„å¾ˆè¯¦ç»†å¾ˆé•¿äº†ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ<em><b><a href=https://www.cnblogs.com/gordon0918/p/5382541.html target=_blank>&nbsp;<i class="fa fa-external-link" aria-hidden=true style=font-size:small></i>è¿™ä½&nbsp;</a></b></em>çš„åšå®¢ã€‚</p><h1 id=ä¸ªäººæ€»ç»“>ä¸ªäººæ€»ç»“</h1><p>å…¶å®ï¼Œæˆ‘åªè¦è®°6æ®µä»£ç å°±å¥½äº†</p><pre><code>openssl genrsa -out pr.pem                                            //ç”Ÿæˆ
openssl rsa -pubout -in pr.pem -out pu.pem                            //æå–
openssl rsautl -pubin -encrypt -in test -inkey pu.pem -out test_en    //åŠ å¯†
openssl rsautl -decrypt -in test_en -inkey pr.pem -out test_dn        //è§£å¯†
openssl dgst -sha256 -sign pr.pem -out test_sign test                 //ç­¾å
openssl dgst -sha256 -verify pu.pem -signature test_sign test         //éªŒè¯
</code></pre><h1 id=å…¶å®ƒ>å…¶å®ƒ</h1><ul><li>è¿™é‡Œçš„å¯†é’¥å¯¹ä¸ä¼šåœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ï¼</li><li><del>åšä¸»çš„æ­£å¼å…¬é’¥ï¼šåœ°å€ï¼š<em><b><a href=https://mega.nz/#!sM4GDIxY target=_blank>&nbsp;<i class="fa fa-external-link" aria-hidden=true style=font-size:small></i>https://mega.nz/#!sM4GDIxY&nbsp;</a></b></em> å¯†é’¥ï¼š<code>!0bW3hOti7GQHtkXYgXY52o8IK9RZVos7hzdZV8fA4uc</code></del> å·²å¼ƒç”¨</li></ul><p>æœ‰é—®é¢˜è¯·åœ¨ä¸‹é¢é—®ï¼ï¼ˆè‡³äºæˆ‘ä¼šä¸ä¼šâ€¦â€¦ğŸ˜­ï¼‰</p></article><section class="article license"><table class=license><tr><td><b>AUTHOR</b></td><td><b>&nbsp;&nbsp;:&nbsp;&nbsp;</b></td><td>Richard Chen</td></tr><tr><td><b>ARTICLE LICENSE</b></td><td><b>&nbsp;&nbsp;:&nbsp;&nbsp;</b></td><td>ff</td></tr><tr><td><b>CODE LICENSE</b></td><td><b>&nbsp;&nbsp;:&nbsp;&nbsp;</b></td><td>dd</td></tr></table></section></div><div class="article bottom"><section class="article navigation"><p>Next: <a class=link href=/post/firewall-of-centos/><span class="iconfont icon-article"></span>CentOS7é˜²ç«å¢™çš„ä½¿ç”¨</a></p><p>Prev: <a class=link href=/post/use-gitalk-in-hexo/><span class="iconfont icon-article"></span>Hexoä¸­Gitalké…ç½®ä½¿ç”¨æ•™ç¨‹-å¯èƒ½æ˜¯ç›®å‰æœ€è¯¦ç»†çš„æ•™ç¨‹</a></p></section></div></section><section id=footer><div class=footer-wrap><span class=copyright>Â©2020 Richard Chen.</span> |
<span class=powerby><span>Powered by</span>
<a href=/powered-by/>these</a><span> projects.</span></span></div></section></body></html>