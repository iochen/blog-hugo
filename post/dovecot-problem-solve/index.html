<!doctype html><html lang=en><meta charset=utf-8><meta name=generator content="Hugo 0.83.1"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><link rel=preload href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/fonts/fontawesome-webfont.woff2?v=4.7.0" as=font crossorigin=anonymous><title>dovecot permission denied 的解决办法&nbsp;&ndash;&nbsp;Richard Chen's Blog</title><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32-mrchen.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16-mrchen.png><meta name=keywords content="dovecot,permission denied,错误,解决方案"><meta name=description content="出现 doveconf: Fatal: Error in ... ssl_cert: ... Can not open file: Permission denied 的解决办法"><link href=https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css rel=stylesheet rel=preload as=style><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/iochen/blog-hugo@public/css/core.min.9c101c701585d7d8a6035683becffa0d0ac3ab87a210677e2db7ed70b53b9ff9a1fcef30a6e0cd7c402ccd9d35425af5.css integrity=sha384-nBAccBWF19imA1aDvs/6DQrDq4eiEGd+LbftcLU7n/mh/O8wpuDNfEAszZ01Qlr1 crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/iochen/blog-hugo@public/css/gitalk.min.css><meta name=twitter:card content="summary"><meta name=twitter:title content="dovecot permission denied 的解决办法"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-110143160-2"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','UA-110143160-2')</script><body><section id=header><div class="header wrap"><span class=header><a class="site home" href=/><img class="site logo" src=https://cdn.jsdelivr.net/gh/iochen/blog-hugo@public/images/logo.svg crossorigin=anonymous alt><span class="site name">Richard Chen's Blog</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class="nav item" href=/categories/>Categories</a>&nbsp;|&nbsp;<a class="nav item" href=/tags/>Tags</a>&nbsp;|&nbsp;<a class="nav item" href=/about/>About</a>&nbsp;|&nbsp;<a class="nav item" href=/contact/>Contact</a>&nbsp;|&nbsp;<a class="nav item" href=/links/>Links</a>&nbsp;|&nbsp;<a class="nav item" href=/search/>Search</a>&nbsp;|&nbsp;<a href=/index.xml>&nbsp;<i class="fa fa-rss fa-lg" aria-hidden=true></i>&nbsp;</a></nav></div></span><span class="m-header right-side"><button onclick="Toggle('menu')" class=menubtn><i class="fa fa-bars fa-lg" aria-hidden=true></i></button></span><ul id=menu class="menu dropdown"><li class=menu-item><a href=/categories/><br>Categories</a></li><li class=menu-item><a href=/tags/><br>Tags</a></li><li class=menu-item><a href=/about/><br>About</a></li><li class=menu-item><a href=/contact/><br>Contact</a></li><li class=menu-item><a href=/links/><br>Links</a></li><li class=menu-item><a href=/search/><br>Search</a></li><li class=menu-item><a href=/index.xml><br><i class="fa fa-rss fa-lg" aria-hidden=true></i></a></li></ul><script>function Toggle(b){var a=document.getElementById(b);a.classList.contains('show')?a.classList.remove('show'):a.classList.add('show')}</script></div></section><section id=content><div class=article-container><section class="article header"><h1 class=title>dovecot permission denied 的解决办法</h1><div class=post-meta><i class="fa fa-calendar-o"></i>&nbsp;<span>2019-07-01</span><a> | </a><i class="fa fa-folder-o"></i>&nbsp;<a class=post-meta href=/categories/issues/>Issues&nbsp;&nbsp;</a></div></section><article class="article markdown-body"><p>今天，在<strong>openSUSE Leap 15.0</strong>上配置<strong>dovecot</strong>的时候，出现了这个错误：</p><pre><code class=language-log>doveconf: Fatal: Error in configuration file /etc/dovecot/dovecot.conf  line 7: ssl_cert: /etc/{some path} Can not open file: Permission  denied
</code></pre><p>以下是我的解决办法</p><h1 id=环境>环境</h1><p>我的SSL证书是由<strong>certbot</strong>颁发的，在<code>/etc/certbot/...</code>下</p><h1 id=错误现象>错误现象</h1><p><strong>systemed</strong>开启<strong>dovecot</strong>时，报错</p><pre><code class=language-log>doveconf: Fatal: Error in configuration file /etc/dovecot/dovecot.conf  line 7: ssl_cert: /etc/{some path} Can not open file: Permission  denied
</code></pre><h1 id=解决方案>解决方案</h1><p>在<code>profiles/apparmor.d/abstractions/ssl_certs</code>中对应位置添加</p><pre><code class=language-c>  /etc/certbot/archive/*/cert*.pem r,
  /etc/certbot/archive/*/chain*.pem r,
  /etc/certbot/archive/*/fullchain*.pem r,
</code></pre><p>在<code>profiles/apparmor.d/abstractions/ssl_keys</code>对应位置添加</p><pre><code>  /etc/certbot/archive/*/privkey*.pem r,
</code></pre><p>详细可参考</p><p><em><b><a href=https://gitlab.com/iochen/apparmor/commit/3016ffb3367e03ee2129401472d44d5eea4c1fb2 target=_blank>&nbsp;<i class="fa fa-external-link" aria-hidden=true style=font-size:small></i>https://gitlab.com/iochen/apparmor/commit/3016ffb3367e03ee2129401472d44d5eea4c1fb2&nbsp;</a></b></em></p><p><em><b><a href=https://gitlab.com/iochen/apparmor/commit/4d275bab696f58e1431d26da642e82adbe092526 target=_blank>&nbsp;<i class="fa fa-external-link" aria-hidden=true style=font-size:small></i>https://gitlab.com/iochen/apparmor/commit/4d275bab696f58e1431d26da642e82adbe092526&nbsp;</a></b></em></p><h1 id=后续>后续</h1><p>已在<em><b><a href=https://gitlab.com/apparmor/apparmor target=_blank>&nbsp;<i class="fa fa-external-link" aria-hidden=true style=font-size:small></i>apparmor官方仓库&nbsp;</a></b></em>中提出<em><b><a href=https://gitlab.com/apparmor/apparmor/merge_requests/397 target=_blank>&nbsp;<i class="fa fa-external-link" aria-hidden=true style=font-size:small></i>PR&nbsp;</a></b></em></p><h1 id=参考>参考</h1><p><em><b><a href=https://forums.opensuse.org/showthread.php/531740-Unexpected-permissions-issue-with-Dovecot target=_blank>&nbsp;<i class="fa fa-external-link" aria-hidden=true style=font-size:small></i>LEAP 42.3 Unexpected permissions issue with Dovecot&nbsp;</a></b></em></p></article><section class="article license"><table class=license><tr><td><b>AUTHOR</b></td><td><b>&nbsp;&nbsp;:&nbsp;&nbsp;</b></td><td>Richard Chen</td></tr><tr><td><b>ARTICLE LICENSE</b></td><td><b>&nbsp;&nbsp;:&nbsp;&nbsp;</b></td><td>CC BY-SA 4.0</td></tr><tr><td><b>CODE LICENSE</b></td><td><b>&nbsp;&nbsp;:&nbsp;&nbsp;</b></td><td>MIT</td></tr></table></section></div><div class="article bottom"><section class="article navigation"><p>Next: <a class=link href=/post/convert-videos-to-audio-on-linux/><span class="iconfont icon-article"></span>Linux下使用FFmpeg,将mp4等格式转mp3格式</a></p><p>Prev: <a class=link href=/post/solved-problem-about-sd-card-formart-on-linux/><span class="iconfont icon-article"></span>Linux上SD卡问题的解决</a></p></section><div id=gitalk-container style=padding-top:2em></div><script src=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js></script><script type=text/javascript>const gitalk=new Gitalk({clientID:"52081976b7a07be56acc",clientSecret:"d8e81c383c5ffc349ddf1b5af168e6608cd1a42d",repo:"gitalk",owner:"iosite",admin:["iosite","iochen"],id:location.pathname,perPage:15,pagerDirection:"last",createIssueManually:!0,distractionFreeMode:!0});gitalk.render("gitalk-container")</script></div></section><section id=footer><div class=footer-wrap><span class=copyright>©2020-2021 Richard Chen.</span> |
<span class=powerby><span>Powered by</span>
<a href=/powered-by/>these</a><span> projects.</span></span></div></section></body></html>